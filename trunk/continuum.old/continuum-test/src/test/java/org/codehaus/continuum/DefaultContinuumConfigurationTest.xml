<configuration>

  <lifecycle-handler-manager implementation='org.codehaus.plexus.lifecycle.DefaultLifecycleHandlerManager'>
    <lifecycle-handlers>
      <lifecycle-handler implementation='org.codehaus.plexus.personality.avalon.AvalonLifecycleHandler'>
        <id>avalon</id>
        <name>Avalon Lifecycle Handler</name>
        <begin-segment>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.LogEnablePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ContextualizePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ServicePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ComposePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ConfigurePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.InitializePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.StartPhase'/>
        </begin-segment>
        <suspend-segment>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.SuspendPhase'/>
        </suspend-segment>
        <resume-segment>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ResumePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.RecontextualizePhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.ReconfigurePhase'/>
        </resume-segment>
        <end-segment>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.StopPhase'/>
          <phase implementation='org.codehaus.plexus.personality.avalon.lifecycle.phase.DisposePhase'/>
        </end-segment>
      </lifecycle-handler>
    </lifecycle-handlers>
  </lifecycle-handler-manager>

  <configurations-directory>${plexus.home}/../../src/main/org/codehaus/plexus/continuum/</configurations-directory>

  <load-on-start>
    <!-- 
     | Only the <components> part is read from the files in <configurations-directory> 
     | so these two services needs to be loaded start.
    -->
    <component>
      <role>org.codehaus.plexus.continuum.network.ConnectionFactory</role>
      <role-hint>trigger-socket</role-hint>
    </component>
    <component>
      <role>org.codehaus.plexus.continuum.network.ConnectionFactory</role>
      <role-hint>registrar-socket</role-hint>
    </component>

    <!-- The SMTP server -->
    <component>
      <role>org.codehaus.plexus.synapse.acceptor.SocketAcceptor</role>
    </component>
  </load-on-start>

  <components>
    <component>
      <role>org.codehaus.plexus.synapse.SynapseServer</role>
      <implementation>org.codehaus.plexus.smtp.DefaultSmtpServer</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
    </component>
    <component>
      <role>org.codehaus.plexus.synapse.acceptor.SocketAcceptor</role>
      <implementation>org.codehaus.plexus.synapse.acceptor.DefaultSocketAcceptor</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
      <configuration>
        <port>10025</port>
      </configuration>
    </component>
    <component>
      <role>org.codehaus.plexus.synapse.reactor.Reactor</role>
      <implementation>org.codehaus.plexus.synapse.reactor.DefaultReactor</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
    </component>
    <component>
      <role>org.codehaus.plexus.synapse.socket.ServerSocketFactory</role>
      <implementation>org.codehaus.plexus.synapse.socket.DefaultServerSocketFactory</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
    </component>
    <component>
      <role>org.codehaus.plexus.dns.DNSResolver</role>
      <implementation>org.codehaus.plexus.dns.DNSJavaResolver</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
    </component>
    <!--
    <component>
      <role>org.codehaus.plexus.smtp.queue.Queue</role>
      <implementation>org.codehaus.plexus.smtp.queue.MemoryQueue</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
    </component>
    -->
    <component>
      <role>org.codehaus.plexus.smtp.queue.Queue</role>
      <implementation>org.codehaus.plexus.smtp.queue.FileQueue</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
      <configuration>
        <directory>mail</directory>
      </configuration>
    </component>
    <component>
      <role>org.codehaus.plexus.synapse.handler.ServiceHandler</role>
      <implementation>org.codehaus.plexus.smtp.SmtpServiceHandler</implementation>
      <lifecycle-handler>avalon</lifecycle-handler>
      <configuration>
        <domain>mail.codehaus.org</domain>
      </configuration>
    </component>
  </components>
</configuration>
